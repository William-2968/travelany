<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»Šå¤©å»å“ªè£¡</title>
    <!-- Tailwind CSS CDN for utility classes -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom fonts for a modern and readable look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap');

        /* Basic body styling for centering and background */
        body {
            font-family: 'Noto Sans TC', 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background for a clean feel */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh; /* Full viewport height */
            margin: 0;
            padding: 20px;
            box-sizing: border-box; /* Include padding in element's total width and height */
        }

        /* Main container for the slot machine application */
        .container {
            background-color: #ffffff; /* White background */
            border-radius: 20px; /* Rounded corners for a softer look */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
            padding: 30px;
            text-align: center;
            max-width: 450px; /* Max width to ensure good mobile display */
            width: 100%; /* Full width within max-width */
            border: 2px solid #cbd5e1; /* Light border for definition */
        }

        /* Title styling */
        h1 {
            color: #2c3e50; /* Dark blue-gray color */
            margin-bottom: 30px;
            font-size: 2.5rem; /* Large font size for prominence */
            font-weight: 700; /* Bold text */
        }

        /* Slot display area styling */
        .slot-display {
            background-color: #ecf0f1; /* Light gray background */
            border-radius: 15px; /* Rounded corners */
            padding: 25px 15px;
            margin-bottom: 30px;
            min-height: 120px; /* Ensures consistent height during animation */
            display: flex;
            flex-direction: column; /* Stack flag and name vertically */
            justify-content: center;
            align-items: center;
            font-size: 2.2rem; /* Large font for readability */
            font-weight: 700;
            color: #34495e; /* Darker text color */
            overflow: hidden; /* Hides content outside the bounds during animation */
            position: relative; /* Needed for absolute positioning of slot items if implemented differently */
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.08); /* Inner shadow for depth */
            border: 1px solid #bdc3c7; /* Light border */
            transition: transform 0.1s ease-out; /* Smooth transition for subtle animations */
        }

        /* Styling for flag emojis */
        .flag-emoji {
            font-size: 3rem; /* Large flag size */
            margin-bottom: 10px;
            display: block; /* Ensures it takes its own line */
        }

        /* Styling for the result text display */
        .result-text {
            font-size: 1.8rem;
            font-weight: 700;
            color: #27ae60; /* Green color for a positive result */
            margin-top: 20px;
            min-height: 60px; /* Reserves space to prevent layout shifts */
            display: flex; /* Uses flexbox for alignment */
            align-items: center; /* Vertically centers content */
            justify-content: center; /* Horizontally centers content */
            flex-wrap: wrap; /* Allows text to wrap on smaller screens */
        }

        /* Adjustments for flag emoji within the result text */
        .result-text .flag-emoji {
            margin-right: 10px; /* Space between flag and text */
            margin-bottom: 0; /* Overrides default margin-bottom from .flag-emoji */
            font-size: 2.5rem; /* Slightly smaller flag in result for better integration */
        }

        /* Base styling for all buttons */
        .button {
            display: inline-block;
            padding: 15px 30px;
            border-radius: 12px; /* Rounded button corners */
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer; /* Indicates interactivity */
            transition: all 0.3s ease; /* Smooth transitions for hover effects */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); /* Standard button shadow */
            text-decoration: none; /* Removes underline from links */
        }

        /* Styling for the "Start Spin" button */
        .start-button {
            background: linear-gradient(135deg, #3498db, #2980b9); /* Blue gradient */
            color: white; /* White text */
            border: none; /* No border */
            margin-bottom: 20px;
        }

        /* Hover effect for the "Start Spin" button */
        .start-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #2980b9, #3498db); /* Reverse gradient on hover */
            transform: translateY(-2px); /* Slight lift effect */
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15); /* Enhanced shadow on hover */
        }

        /* Disabled state for the "Start Spin" button */
        .start-button:disabled {
            background: #cccccc; /* Gray background when disabled */
            cursor: not-allowed; /* Not-allowed cursor */
            box-shadow: none; /* No shadow when disabled */
        }

        /* Styling for the "Recommend" button */
        .recommend-button {
            background: linear-gradient(135deg, #f39c12, #e67e22); /* Orange gradient */
            color: white; /* White text */
            border: none; /* No border */
            display: none; /* Hidden by default, shown after spin */
            margin-top: 20px;
        }

        /* Hover effect for the "Recommend" button */
        .recommend-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #e67e22, #f39c12); /* Reverse gradient on hover */
            transform: translateY(-2px); /* Slight lift effect */
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15); /* Enhanced shadow on hover */
        }

        /* Responsive adjustments for smaller screens (e.g., mobile phones) */
        @media (max-width: 600px) {
            h1 {
                font-size: 2rem; /* Smaller title on mobile */
            }
            .slot-display {
                font-size: 1.8rem; /* Smaller slot text on mobile */
                padding: 20px 10px;
            }
            .flag-emoji {
                font-size: 2.5rem; /* Smaller flag in slot on mobile */
            }
            .result-text {
                font-size: 1.5rem; /* Smaller result text on mobile */
            }
            .result-text .flag-emoji {
                font-size: 2rem; /* Smaller flag in result on mobile */
            }
            .button {
                padding: 12px 25px; /* Smaller padding for buttons on mobile */
                font-size: 1.1rem; /* Smaller font for buttons on mobile */
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ä»Šå¤©å»å“ªè£¡</h1>

        <div id="slotDisplay" class="slot-display">
            <!-- Slot content will be dynamically updated here during spinning -->
            <span class="flag-emoji" id="slotFlag">ğŸŒ</span>
            <span id="slotCountryName">æº–å‚™æŠ½ç±¤...</span>
        </div>

        <button id="startButton" class="button start-button">é–‹å§‹æŠ½ç±¤</button>

        <div id="resultDisplay" class="result-text"></div>

        <a id="recommendButton" class="button recommend-button" target="_blank" rel="noopener noreferrer">ç†±é–€æ™¯é»æ¨è–¦</a>
    </div>

    <script>
        // Helper function to convert a two-letter ISO country code to its corresponding Unicode flag emoji.
        // For example, "US" becomes "ğŸ‡ºğŸ‡¸".
        function getFlagEmoji(countryCode) {
            // If no country code is provided, return a generic globe or question mark emoji.
            if (!countryCode) return 'â“';
            // Convert each character of the country code to its regional indicator symbol.
            // 'A' becomes 0x1F1E6, 'B' becomes 0x1F1E7, and so on.
            const codePoints = countryCode
                .toUpperCase()
                .split('')
                .map(char => 0x1F1E6 + (char.charCodeAt(0) - 'A'.charCodeAt(0)));
            // Combine the code points into a single string to form the emoji.
            return String.fromCodePoint(...codePoints);
        }

        // Get references to DOM elements
        const slotDisplay = document.getElementById('slotDisplay');
        const slotFlag = document.getElementById('slotFlag');
        const slotCountryName = document.getElementById('slotCountryName');
        const startButton = document.getElementById('startButton');
        const resultDisplay = document.getElementById('resultDisplay');
        const recommendButton = document.getElementById('recommendButton');

        // State variables for the spinning animation
        let spinning = false; // True if the slot machine is currently spinning
        let currentCountryIndex = 0; // Index of the country currently displayed in the slot
        let animationStartTime; // Timestamp when the spinning started
        const totalAnimationDuration = 5000; // Total duration of the spinning animation in milliseconds (5 seconds)
        const baseFrameInterval = 50; // Base interval for updating the display during rapid spin (50ms = 20 frames/sec)

        // Array to hold country data.
        // --- è«‹å°‡æ‚¨çš„ Notion åœ‹å®¶è³‡æ–™è²¼åˆ°é€™è£¡ ---
        // æ¯å€‹ç‰©ä»¶æ‡‰åŒ…å«: chineseName (ä¸­æ–‡åç¨±), englishName (è‹±æ–‡åç¨±), flagCode (åœ‹æ——ä»£ç¢¼), continent (æ´²åˆ¥)
        // ç¯„ä¾‹è³‡æ–™ (è«‹æ›¿æ›ç‚ºæ‚¨çš„å¯¦éš›è³‡æ–™):
        const countries = [
            { chineseName: "ç¾åœ‹", englishName: "United States", flagCode: "US", continent: "åŒ—ç¾æ´²" },
            { chineseName: "æ—¥æœ¬", englishName: "Japan", flagCode: "JP", continent: "äºæ´²" },
            { chineseName: "æ³•åœ‹", englishName: "France", flagCode: "FR", continent: "æ­æ´²" },
            { chineseName: "æ¾³æ´²", englishName: "Australia", flagCode: "AU", continent: "å¤§æ´‹æ´²" },
            { chineseName: "å·´è¥¿", englishName: "Brazil", flagCode: "BR", continent: "å—ç¾æ´²" },
            { chineseName: "åŸƒåŠ", englishName: "Egypt", flagCode: "EG", continent: "éæ´²" },
            { chineseName: "å¾·åœ‹", englishName: "Germany", flagCode: "DE", continent: "æ­æ´²" },
            { chineseName: "åŠ æ‹¿å¤§", englishName: "Canada", flagCode: "CA", continent: "åŒ—ç¾æ´²" },
            { chineseName: "å°åº¦", englishName: "India", flagCode: "IN", continent: "äºæ´²" },
            { chineseName: "å—é", englishName: "South Africa", flagCode: "ZA", continent: "éæ´²" },
            { chineseName: "ç´è¥¿è˜­", englishName: "New Zealand", flagCode: "NZ", continent: "å¤§æ´‹æ´²" },
            { chineseName: "é˜¿æ ¹å»·", englishName: "Argentina", flagCode: "AR", continent: "å—ç¾æ´²" },
            { chineseName: "ä¸­åœ‹", englishName: "China", flagCode: "CN", continent: "äºæ´²" },
            { chineseName: "è‹±åœ‹", englishName: "United Kingdom", flagCode: "GB", continent: "æ­æ´²" },
            { chineseName: "å¢¨è¥¿å“¥", englishName: "Mexico", flagCode: "MX", continent: "åŒ—ç¾æ´²" },
            { chineseName: "ç¾©å¤§åˆ©", englishName: "Italy", flagCode: "IT", continent: "æ­æ´²" },
            { chineseName: "éŸ“åœ‹", englishName: "South Korea", flagCode: "KR", continent: "äºæ´²" },
            { chineseName: "è¥¿ç­ç‰™", englishName: "Spain", flagCode: "ES", continent: "æ­æ´²" },
            { chineseName: "ä¿„ç¾…æ–¯", englishName: "Russia", flagCode: "RU", continent: "æ­æ´²/äºæ´²" },
            { chineseName: "æ²™çƒåœ°é˜¿æ‹‰ä¼¯", englishName: "Saudi Arabia", flagCode: "SA", continent: "äºæ´²" },
            { chineseName: "ç‘å…¸", englishName: "Sweden", flagCode: "SE", continent: "æ­æ´²" },
            { chineseName: "æŒªå¨", englishName: "Norway", flagCode: "NO", continent: "æ­æ´²" },
            { chineseName: "ä¸¹éº¥", englishName: "Denmark", flagCode: "DK", continent: "æ­æ´²" },
            { chineseName: "èŠ¬è˜­", englishName: "Finland", flagCode: "FI", continent: "æ­æ´²" },
            { chineseName: "ç‘å£«", englishName: "Switzerland", flagCode: "CH", continent: "æ­æ´²" },
            { chineseName: "è·è˜­", englishName: "Netherlands", flagCode: "NL", continent: "æ­æ´²" },
            { chineseName: "æ¯”åˆ©æ™‚", englishName: "Belgium", flagCode: "BE", continent: "æ­æ´²" },
            { chineseName: "å¥§åœ°åˆ©", englishName: "Austria", flagCode: "AT", continent: "æ­æ´²" },
            { chineseName: "å¸Œè‡˜", englishName: "Greece", flagCode: "GR", continent: "æ­æ´²" },
            { chineseName: "åœŸè€³å…¶", englishName: "Turkey", flagCode: "TR", continent: "äºæ´²/æ­æ´²" },
            { chineseName: "æ³°åœ‹", englishName: "Thailand", flagCode: "TH", continent: "äºæ´²" },
            { chineseName: "è¶Šå—", englishName: "Vietnam", flagCode: "VN", continent: "äºæ´²" },
            { chineseName: "å°å°¼", englishName: "Indonesia", flagCode: "ID", continent: "äºæ´²" },
            { chineseName: "é¦¬ä¾†è¥¿äº", englishName: "Malaysia", flagCode: "MY", continent: "äºæ´²" },
            { chineseName: "è²å¾‹è³“", englishName: "Philippines", flagCode: "PH", continent: "äºæ´²" },
            { chineseName: "æ–°åŠ å¡", englishName: "Singapore", flagCode: "SG", continent: "äºæ´²" },
            { chineseName: "é˜¿æ‹‰ä¼¯è¯åˆå¤§å…¬åœ‹", englishName: "United Arab Emirates", flagCode: "AE", continent: "äºæ´²" },
            { chineseName: "ä»¥è‰²åˆ—", englishName: "Israel", flagCode: "IL", continent: "äºæ´²" },
            { chineseName: "å“¥å€«æ¯”äº", englishName: "Colombia", flagCode: "CO", continent: "å—ç¾æ´²" },
            { chineseName: "ç§˜é­¯", englishName: "Peru", flagCode: "PE", continent: "å—ç¾æ´²" },
            { chineseName: "æ™ºåˆ©", englishName: "Chile", flagCode: "CL", continent: "å—ç¾æ´²" },
            { chineseName: "å—é", englishName: "South Africa", flagCode: "ZA", continent: "éæ´²" },
            { chineseName: "è‚¯äº", englishName: "Kenya", flagCode: "KE", continent: "éæ´²" },
            { chineseName: "æ‘©æ´›å“¥", englishName: "Morocco", flagCode: "MA", continent: "éæ´²" },
            { chineseName: "å¥ˆåŠåˆ©äº", englishName: "Nigeria", flagCode: "NG", continent: "éæ´²" },
            { chineseName: "ç´è¥¿è˜­", englishName: "New Zealand", flagCode: "NZ", continent: "å¤§æ´‹æ´²" },
            { chineseName: "æ–æ¿Ÿ", englishName: "Fiji", flagCode: "FJ", continent: "å¤§æ´‹æ´²" },
            { chineseName: "å†°å³¶", englishName: "Iceland", flagCode: "IS", continent: "æ­æ´²" },
            { chineseName: "æ„›çˆ¾è˜­", englishName: "Ireland", flagCode: "IE", continent: "æ­æ´²" },
            { chineseName: "è‘¡è„ç‰™", englishName: "Portugal", flagCode: "PT", continent: "æ­æ´²" },
            { chineseName: "æ·å…‹", englishName: "Czech Republic", flagCode: "CZ", continent: "æ­æ´²" },
            { chineseName: "åŒˆç‰™åˆ©", englishName: "Hungary", flagCode: "HU", continent: "æ­æ´²" },
            { chineseName: "æ³¢è˜­", englishName: "Poland", flagCode: "PL", continent: "æ­æ´²" },
            { chineseName: "ç¾…é¦¬å°¼äº", englishName: "Romania", flagCode: "RO", continent: "æ­æ´²" },
            { chineseName: "çƒå…‹è˜­", englishName: "Ukraine", flagCode: "UA", continent: "æ­æ´²" },
            { chineseName: "å…‹ç¾…åŸƒè¥¿äº", englishName: "Croatia", flagCode: "HR", continent: "æ­æ´²" },
            { chineseName: "å¡çˆ¾ç¶­äº", englishName: "Serbia", flagCode: "RS", continent: "æ­æ´²" },
            { chineseName: "ä¿åŠ åˆ©äº", englishName: "Bulgaria", flagCode: "BG", continent: "æ­æ´²" },
            { chineseName: "æ–¯æ´›ä¼å…‹", englishName: "Slovakia", flagCode: "SK", continent: "æ­æ´²" },
            { chineseName: "æ–¯æ´›ç¶­å°¼äº", englishName: "Slovenia", flagCode: "SI", continent: "æ­æ´²" },
            { chineseName: "ç«‹é™¶å®›", englishName: "Lithuania", flagCode: "LT", continent: "æ­æ´²" },
            { chineseName: "æ‹‰è„«ç¶­äº", englishName: "Latvia", flagCode: "LV", continent: "æ­æ´²" },
            { chineseName: "æ„›æ²™å°¼äº", englishName: "Estonia", flagCode: "EE", continent: "æ­æ´²" },
            { chineseName: "å­ŸåŠ æ‹‰", englishName: "Bangladesh", flagCode: "BD", continent: "äºæ´²" },
            { chineseName: "å·´åŸºæ–¯å¦", englishName: "Pakistan", flagCode: "PK", continent: "äºæ´²" },
            { chineseName: "æ–¯é‡Œè˜­å¡", englishName: "Sri Lanka", flagCode: "LK", continent: "äºæ´²" },
            { chineseName: "å°¼æ³Šçˆ¾", englishName: "Nepal", flagCode: "NP", continent: "äºæ´²" },
            { chineseName: "è’™å¤", englishName: "Mongolia", flagCode: "MN", continent: "äºæ´²" },
            { chineseName: "å“ˆè–©å…‹", englishName: "Kazakhstan", flagCode: "KZ", continent: "äºæ´²" },
            { chineseName: "çƒèŒ²åˆ¥å…‹", englishName: "Uzbekistan", flagCode: "UZ", continent: "äºæ´²" },
            { chineseName: "ç´„æ—¦", englishName: "Jordan", flagCode: "JO", continent: "äºæ´²" },
            { chineseName: "é»å·´å«©", englishName: "Lebanon", flagCode: "LB", continent: "äºæ´²" },
            { chineseName: "æ•˜åˆ©äº", englishName: "Syria", flagCode: "SY", continent: "äºæ´²" },
            { chineseName: "ä¼Šæ‹‰å…‹", englishName: "Iraq", flagCode: "IQ", continent: "äºæ´²" },
            { chineseName: "ä¼Šæœ—", englishName: "Iran", flagCode: "IR", continent: "äºæ´²" },
            { chineseName: "è‘‰é–€", englishName: "Yemen", flagCode: "YE", continent: "äºæ´²" },
            { chineseName: "é˜¿æ›¼", englishName: "Oman", flagCode: "OM", continent: "äºæ´²" },
            { chineseName: "å¡é”", englishName: "Qatar", flagCode: "QA", continent: "äºæ´²" },
            { chineseName: "ç§‘å¨ç‰¹", englishName: "Kuwait", flagCode: "KW", continent: "äºæ´²" },
            { chineseName: "å·´æ—", englishName: "Bahrain", flagCode: "BH", continent: "äºæ´²" },
            { chineseName: "è³½æ™®å‹’æ–¯", englishName: "Cyprus", flagCode: "CY", continent: "äºæ´²/æ­æ´²" },
            { chineseName: "å–¬æ²»äº", englishName: "Georgia", flagCode: "GE", continent: "äºæ´²/æ­æ´²" },
            { chineseName: "äºç¾å°¼äº", englishName: "Armenia", flagCode: "AM", continent: "äºæ´²" },
            { chineseName: "äºå¡æ‹œç„¶", englishName: "Azerbaijan", flagCode: "AZ", continent: "äºæ´²" },
            { chineseName: "å¤å·´", englishName: "Cuba", flagCode: "CU", continent: "åŒ—ç¾æ´²" },
            { chineseName: "ç‰™è²·åŠ ", englishName: "Jamaica", flagCode: "JM", continent: "åŒ—ç¾æ´²" },
            { chineseName: "å¤šæ˜å°¼åŠ ", englishName: "Dominican Republic", flagCode: "DO", continent: "åŒ—ç¾æ´²" },
            { chineseName: "å“¥æ–¯å¤§é»åŠ ", englishName: "Costa Rica", flagCode: "CR", continent: "åŒ—ç¾æ´²" },
            { chineseName: "å·´æ‹¿é¦¬", englishName: "Panama", flagCode: "PA", continent: "åŒ—ç¾æ´²" },
            { chineseName: "å§”å…§ç‘æ‹‰", englishName: "Venezuela", flagCode: "VE", continent: "å—ç¾æ´²" },
            { chineseName: "å„ç“œå¤š", englishName: "Ecuador", flagCode: "EC", continent: "å—ç¾æ´²" },
            { chineseName: "ç»åˆ©ç¶­äº", englishName: "Bolivia", flagCode: "BO", continent: "å—ç¾æ´²" },
            { chineseName: "å·´æ‹‰åœ­", englishName: "Paraguay", flagCode: "PY", continent: "å—ç¾æ´²" },
            { chineseName: "çƒæ‹‰åœ­", englishName: "Uruguay", flagCode: "UY", continent: "å—ç¾æ´²" },
            { chineseName: "è¡£ç´¢æ¯”äº", englishName: "Ethiopia", flagCode: "ET", continent: "éæ´²" },
            { chineseName: "å¦å°šå°¼äº", englishName: "Tanzania", flagCode: "TZ", continent: "éæ´²" },
            { chineseName: "åŠ ç´", englishName: "Ghana", flagCode: "GH", continent: "éæ´²" },
            { chineseName: "è±¡ç‰™æµ·å²¸", englishName: "Ivory Coast", flagCode: "CI", continent: "éæ´²" },
            { chineseName: "å–€éº¥éš†", englishName: "Cameroon", flagCode: "CM", continent: "éæ´²" },
            { chineseName: "å‰›æœæ°‘ä¸»å…±å’Œåœ‹", englishName: "DR Congo", flagCode: "CD", continent: "éæ´²" },
            { chineseName: "é¦¬é”åŠ æ–¯åŠ ", englishName: "Madagascar", flagCode: "MG", continent: "éæ´²" },
            { chineseName: "æ¨¡é‡Œè¥¿æ–¯", englishName: "Mauritius", flagCode: "MU", continent: "éæ´²" },
            { chineseName: "æ¾³æ´²", englishName: "Australia", flagCode: "AU", continent: "å¤§æ´‹æ´²" },
            { chineseName: "å·´å¸ƒäºç´å¹¾å…§äº", englishName: "Papua New Guinea", flagCode: "PG", continent: "å¤§æ´‹æ´²" },
            { chineseName: "ç´¢ç¾…é–€ç¾¤å³¶", englishName: "Solomon Islands", flagCode: "SB", continent: "å¤§æ´‹æ´²" },
            { chineseName: "è¬é‚£æœ", englishName: "Vanuatu", flagCode: "VU", continent: "å¤§æ´‹æ´²" },
            { chineseName: "æ±åŠ ", englishName: "Tonga", flagCode: "TO", continent: "å¤§æ´‹æ´²" },
            { chineseName: "è–©æ‘©äº", englishName: "Samoa", flagCode: "WS", continent: "å¤§æ´‹æ´²" },
            { chineseName: "å‰é‡Œå·´æ–¯", englishName: "Kiribati", flagCode: "KI", continent: "å¤§æ´‹æ´²" },
            { chineseName: "å¯†å…‹ç¾…å°¼è¥¿äº", englishName: "Micronesia", flagCode: "FM", continent: "å¤§æ´‹æ´²" },
            { chineseName: "é¦¬ç´¹çˆ¾ç¾¤å³¶", englishName: "Marshall Islands", flagCode: "MH", continent: "å¤§æ´‹æ´²" },
            { chineseName: "è«¾é­¯", englishName: "Nauru", flagCode: "NR", continent: "å¤§æ´‹æ´²" },
            { chineseName: "å¸›ç‰", englishName: "Palau", flagCode: "PW", continent: "å¤§æ´‹æ´²" },
            { chineseName: "åç“¦é­¯", englishName: "Tuvalu", flagCode: "TV", continent: "å¤§æ´‹æ´²" },
            { chineseName: "é˜¿çˆ¾å·´å°¼äº", englishName: "Albania", flagCode: "AL", continent: "æ­æ´²" },
            { chineseName: "æ³¢å£«å°¼äºèˆ‡èµ«å¡å“¥ç¶­ç´", englishName: "Bosnia and Herzegovina", flagCode: "BA", continent: "æ­æ´²" },
            { chineseName: "è’™ç‰¹å…§å“¥ç¾…", englishName: "Montenegro", flagCode: "ME", continent: "æ­æ´²" },
            { chineseName: "åŒ—é¦¬å…¶é “", englishName: "North Macedonia", flagCode: "MK", continent: "æ­æ´²" },
            { chineseName: "ç§‘ç´¢æ²ƒ", englishName: "Kosovo", flagCode: "XK", continent: "æ­æ´²" }, /* XK is user-assigned code for Kosovo */
            { chineseName: "é¦¬çˆ¾ä»–", englishName: "Malta", flagCode: "MT", continent: "æ­æ´²" },
            { chineseName: "ç›§æ£®å ¡", englishName: "Luxembourg", flagCode: "LU", continent: "æ­æ´²" },
            { chineseName: "åˆ—æ”¯æ•¦æ–¯ç™»", englishName: "Liechtenstein", flagCode: "LI", continent: "æ­æ´²" },
            { chineseName: "æ‘©ç´å“¥", englishName: "Monaco", flagCode: "MC", continent: "æ­æ´²" },
            { chineseName: "è–é¦¬åˆ©è«¾", englishName: "San Marino", flagCode: "SM", continent: "æ­æ´²" },
            { chineseName: "æ¢µè’‚å²¡", englishName: "Vatican City", flagCode: "VA", continent: "æ­æ´²" },
            { chineseName: "å®‰é“çˆ¾", englishName: "Andorra", flagCode: "AD", continent: "æ­æ´²" },
            { chineseName: "å†°å³¶", englishName: "Iceland", flagCode: "IS", continent: "æ­æ´²" },
            { chineseName: "ç™½ä¿„ç¾…æ–¯", englishName: "Belarus", flagCode: "BY", continent: "æ­æ´²" },
            { chineseName: "æ‘©çˆ¾å¤šç“¦", englishName: "Moldova", flagCode: "MD", continent: "æ­æ´²" },
            { chineseName: "çƒèŒ²åˆ¥å…‹", englishName: "Uzbekistan", flagCode: "UZ", continent: "äºæ´²" },
            { chineseName: "åœŸåº«æ›¼", englishName: "Turkmenistan", flagCode: "TM", continent: "äºæ´²" },
            { chineseName: "å¡”å‰å…‹", englishName: "Tajikistan", flagCode: "TJ", continent: "äºæ´²" },
            { chineseName: "å‰çˆ¾å‰æ–¯", englishName: "Kyrgyzstan", flagCode: "KG", continent: "äºæ´²" },
            { chineseName: "é˜¿å¯Œæ±—", englishName: "Afghanistan", flagCode: "AF", continent: "äºæ´²" },
            { chineseName: "ä¸ä¸¹", englishName: "Bhutan", flagCode: "BT", continent: "äºæ´²" },
            { chineseName: "ç·¬ç”¸", englishName: "Myanmar", flagCode: "MM", continent: "äºæ´²" },
            { chineseName: "å¯®åœ‹", englishName: "Laos", flagCode: "LA", continent: "äºæ´²" },
            { chineseName: "æŸ¬åŸ”å¯¨", englishName: "Cambodia", flagCode: "KH", continent: "äºæ´²" },
            { chineseName: "æ±å¸æ±¶", englishName: "Timor-Leste", flagCode: "TL", continent: "äºæ´²" },
            { chineseName: "æ±¶èŠ", englishName: "Brunei", flagCode: "BN", continent: "äºæ´²" },
        ];
        // --- åœ‹å®¶è³‡æ–™çµæŸ ---

        // Function to update the content of the slot display area.
        function updateSlotDisplay(country) {
            slotFlag.textContent = getFlagEmoji(country.flagCode); // Set the flag emoji
            slotCountryName.textContent = country.chineseName; // Set the Chinese country name
        }

        // Main animation loop for the spinning effect.
        // This function is called repeatedly using setTimeout to create the animation.
        function spinAnimationLoop() {
            // If spinning is false, stop the loop.
            if (!spinning) return;

            // Calculate elapsed time since the animation started.
            const elapsedTime = Date.now() - animationStartTime;
            let currentDelay = baseFrameInterval; // Start with the base interval

            // If the total animation duration has not passed yet, continue spinning.
            if (elapsedTime < totalAnimationDuration) {
                // Calculate progress (0 to 1) of the animation.
                const progress = elapsedTime / totalAnimationDuration;
                // Apply a cubic easing function to the progress for a smoother slowdown effect.
                // This makes the slot slow down more dramatically towards the end.
                const easedProgress = progress * progress * progress;
                
                // Increase the delay between frames significantly as progress increases.
                // This creates the slowing down effect.
                currentDelay = baseFrameInterval + (baseFrameInterval * 15 * easedProgress);

                // Move to the next country in the array, looping back to the beginning if needed.
                currentCountryIndex = (currentCountryIndex + 1) % countries.length;
                // Update the display with the new country.
                updateSlotDisplay(countries[currentCountryIndex]);

                // Add a subtle vertical bounce animation to the slot display during spin.
                // Math.sin creates a wave-like motion, making it more dynamic.
                slotDisplay.style.transform = `translateY(${Math.sin(elapsedTime / 100) * 8}px)`;
                // Apply a quick transition for the bounce effect.
                slotDisplay.style.transition = 'transform 0.05s ease-out';

                // Schedule the next frame of the animation.
                setTimeout(spinAnimationLoop, currentDelay);
            } else {
                // Animation time is up, stop the spinning.
                // Choose a random country as the final result.
                const finalIndex = Math.floor(Math.random() * countries.length);
                currentCountryIndex = finalIndex; // Set the current index to the final chosen country
                updateSlotDisplay(countries[currentCountryIndex]); // Update display one last time
                stopSpinning(); // Call the function to finalize the spin
            }
        }

        // Function to start the spinning animation.
        function startSpinning() {
            // Prevent starting a new spin if one is already in progress.
            if (spinning) return;
            // If there are no countries to choose from, display a message and disable the button.
            if (countries.length === 0) {
                resultDisplay.textContent = "æ²’æœ‰åœ‹å®¶è³‡æ–™å¯ä¾›æŠ½ç±¤ï¼";
                return;
            }

            spinning = true; // Set spinning state to true
            startButton.disabled = true; // Disable the start button during spin
            resultDisplay.innerHTML = ''; // Clear any previous result text
            recommendButton.style.display = 'none'; // Hide the "Recommend" button

            animationStartTime = Date.now(); // Record the start time of the animation
            spinAnimationLoop(); // Begin the animation loop
        }

        // Function to stop the spinning animation and display the result.
        function stopSpinning() {
            spinning = false; // Set spinning state to false
            startButton.disabled = false; // Re-enable the start button

            // Reset the slot display's transform properties (remove bounce and scale).
            slotDisplay.style.transform = 'translateY(0) scale(1)';
            // Apply a smooth transition for this reset.
            slotDisplay.style.transition = 'transform 0.3s ease-out';

            // Get the randomly selected country.
            const selectedCountry = countries[currentCountryIndex];
            // Update the result display with the flag, Chinese name, and continent.
            resultDisplay.innerHTML = `<span class="flag-emoji">${getFlagEmoji(selectedCountry.flagCode)}</span> ${selectedCountry.chineseName} (${selectedCountry.continent})`;

            // Add a subtle "pop" animation to the slot display when it stops.
            // Briefly scale up then back down to draw attention.
            slotDisplay.style.transform = 'scale(1.05)'; // Scale up slightly
            setTimeout(() => {
                slotDisplay.style.transform = 'scale(1)'; // Scale back to normal
            }, 150); // Short delay for the "pop" effect


            // Construct the Perplexity URL with the chosen country's name.
            // The query is URL-encoded to handle special characters.
            const perplexityQuery = `è«‹ä»¥ç¹é«”ä¸­æ–‡100å€‹å­—ä»‹ç´¹${selectedCountry.chineseName}çš„ç†±é–€æ™¯é»`;
            const perplexityUrl = `https://www.perplexity.ai/search?q=${encodeURIComponent(perplexityQuery)}`;
            recommendButton.href = perplexityUrl; // Set the link for the recommend button
            recommendButton.style.display = 'inline-block'; // Show the "Recommend" button
        }

        // Add an event listener to the start button to trigger the spinning.
        startButton.addEventListener('click', startSpinning);

        // Initial setup when the page loads.
        // If there are countries in the data array, display the first one.
        // Otherwise, indicate that no data is available and disable the button.
        if (countries.length > 0) {
            updateSlotDisplay(countries[0]);
        } else {
            slotCountryName.textContent = "ç„¡åœ‹å®¶è³‡æ–™";
            startButton.disabled = true;
        }
    </script>
</body>
</html>
